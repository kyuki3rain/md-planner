# 2025-10-09 レビュー修正ポイント

## 1. テスト期待値の更新
- `src/application/services/task-index.service.spec.ts`
  - `initialize` が再初期化を許容する実装に合わせ、二重初期化時に例外を投げない前提へ期待値を更新する。
  - パーサが `issues` を返す場合でもタスク生成と両立する挙動に合わせて検証内容を修正する。
- `src/application/usecases/build-task-index.usecase.spec.ts`
  - タスク生成と同時に issue が収集される現仕様に追随し、`tasks`/`issues` の期待値を見直す。
- `src/infrastructure/parsers/markdown-task-parser.spec.ts`
  - ID欠落時にULID自動採番でタスクが生成される仕様を前提に、タスク件数と issue 数の検証を調整する。
- `src/infrastructure/scanner/file-system-task-scanner.spec.ts`
  - `filePath` が絶対パスを返す実装に合わせ、期待値比較を絶対パス基準に変更する。

## 2. Webview と UseCase の属性連携強化
- `src/interface/webview/board-view-panel.ts`
  - `task:create`／`task:update` ハンドラーで受け取った属性情報を `CreateTaskInput`／`UpdateTaskInput` に橋渡しする。
  - `attributes` への型変換・バリデーションを追加し、期日や担当者等が Markdown へ反映されるようにする。
- `src/application/usecases/create-task.usecase.ts` / `update-task.usecase.ts`
  - 受け取った属性を正規化し `TaskFactory` でのバリデーションに通す処理を追加する（`TaskAttributesSchema` を活用）。

## 3. TaskEditModal の状態同期
- `webview/src/components/TaskEditModal.tsx`
  - `task` prop が変更された際にフォーム値を再同期する `useEffect` を追加するか、完全にコントロールドコンポーネントへリファクタする。
  - モーダル再オープン時に前回値が残る問題を解消し、最新タスク内容が表示されるようにする。

## 4. Lint コメントとドキュメント整備
- `webview/src/views/BoardView.tsx`
  - `// biome-ignore lint/correctness/useExhaustiveDependencies: <explanation>` の `<explanation>` を具体的な理由（`sendMessage` の参照安定性など）で埋める。
- `docs/残タスクリスト.md` など進捗ドキュメント
  - WebviewPanel への移行や Markdown ファイル指定起動が完了済みである旨を反映させ、コードとドキュメントの差異をなくす。

## 5. フォローアップ
- 上記修正後に `pnpm test` を再実行し、全 69 テストがパスすることを確認する。
- 必要に応じて `pnpm run compile`（`typecheck`/`lint`/`build`）でリグレッションを検知する。
